<!doctype html>
<!--suppress NonAsciiCharacters -->
<html lang="de" class="h-100">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Feuerwehr Einsatzmonitor</title>

    <!-- Bootstrap core CSS -->
    <link href="./static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap colorpicker -->
    <link href="./static/css/bootstrap-colorpicker.min.css" rel="stylesheet">

    <!-- noUiSlider -->
    <link href="./static/css/nouislider.min.css" rel="stylesheet">
    <link href="./static/css/jquery-ui.css" rel="stylesheet">

    <!-- FontAwesome -->
    <link href="./static/fontawesome-pro-5.0.13/web-fonts-with-css/css/fontawesome-all.min.css" rel="stylesheet">

    <!-- toastr -->
    <link href="./static/css/toastr.min.css" rel="stylesheet">

    <!-- fonts -->
    <link href="./static/css/fonts.css" rel="stylesheet">

    <!-- gridster -->
    <link href="./static/css/gridster.css" rel="stylesheet">

    <!-- einsatzmonitor -->
    <link href="./static/css/einsatzmonitor.css" rel="stylesheet">
</head>

<body class="h-100" data-bind="style: {'backgroundImage': 'url('+ backgroundUrl() +')', 'backgroundColor': backgroundColor }">

<div class="template-output"></div>

<div class="container d-flex flex-column h-100 px-0">
    <div class="gridster-test">
        <div class="gridster" id="gridsterInfo">
            <ul class="m-0" data-bind="template: { name: board().templateName, foreach: board().widgets, as: 'widget', afterAdd: board().addGridster, beforeRemove: board().removeGridster }"></ul>
        </div>
    </div>

    <div id="addWidgetModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Widget hinzufügen</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h4>Info-Widgets</h4>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("clock-widget") }'><i class="fal fa-plus"></i> Uhr</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("date-widget") }'><i class="fal fa-plus"></i> Datum</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("image-widget") }'><i class="fal fa-plus"></i> Bild</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("weather-widget") }'><i class="fal fa-plus"></i> Wetter</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("vehicle-widget") }'><i class="fal fa-plus"></i> Fahrzeuge</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("text-widget") }'><i class="fal fa-plus"></i> Text</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("info-news-widget") }'><i class="fal fa-plus"></i> News</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("info-dienste-widget") }'><i class="fal fa-plus"></i> Dienste</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("info-operations-widget") }'><i class="fal fa-plus"></i> Einsätze</button>
                    <button class="btn btn-outline-success mt-1" data-bind='click: function(data, event) { addWidget("alarm-history-widget") }'><i class="fal fa-plus"></i> Einsatzhistorie</button>

                    <!-- <button class="btn btn-outline-success mt-1" data-bind='click: serialize'> Serialize </button> -->

                    <h4 class="mt-5">Einsatz-Widgets</h4>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-keyword") }'><i class="fal fa-plus"></i> Stichwort</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-address") }'><i class="fal fa-plus"></i> Adresse</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-additionalInformation") }'><i class="fal fa-plus"></i> Zusatzinfos</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-routeInformation") }'><i class="fal fa-plus"></i> Route - Informationen</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-units") }'><i class="fal fa-plus"></i> Einheiten</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-feedback") }'><i class="fal fa-plus"></i> Rückmeldungen</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-feedback-count") }'><i class="fal fa-plus"></i> Anzahl Rückmeldungen</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-alarmMinutes") }'><i class="fal fa-plus"></i> Minuten seit Alarmierung</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-overviewMap") }'><i class="fal fa-plus"></i> Karte - Übersicht</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-routeMap") }'><i class="fal fa-plus"></i> Karte - Anfahrtsweg</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-customParameter") }'><i class="fal fa-plus"></i> Eigener Parameter</button>
                    <button class="btn btn-outline-danger mt-1" data-bind='click: function(data, event) { addWidget("operation-aao") }'><i class="fal fa-plus"></i> AAO</button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bind='click: board().openSettingsMenuModal' data-dismiss="modal">Zurück</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsMenuModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Einstellungen</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h4>Funktionen</h4>

                    <label for="inputAlamosDbId"><strong>Alamos Feedback-ID für Testeinsatz</strong></label>
                    <input type="text" class="form-control mb-2" id="inputAlamosDbId" data-bind="textInput: testOperationFe2Id">

                    <label for="inputAdresse"><strong>Adresse für Testeinsatz</strong></label>
                    <input type="text" class="form-control mb-2" id="inputAdresse" data-bind="textInput: testOperationAddress">
                    <div class="row">
                        <div class="col">
                            <button class="btn btn-warning btn-block" data-bind='click: addTestOperation'><i class="fal fa-play"></i> Testeinsatz starten</button>
                        </div>
                        <div class="col">
                            <button class="btn btn-outline-danger btn-block" data-bind='click: clearOperations'><i class="fal fa-stop"></i> Einsatz beenden</button>
                        </div>
                    </div>

                    <h4 class="mt-5">Ansicht</h4>
                    <button class="btn btn-success" data-bind='click: save'><i class="fal fa-save"></i> Widgets dieser Ansicht speichern</button>
                    <button class="btn btn-success mt-2" data-bind='click: loadView'><i class="fal fa-download"></i> Widgets dieser Ansicht laden</button>

                    <h4 class="mt-5">Widgets</h4>
                    <button class="btn btn-success" data-bind='click: board().openWidgetAddModal' data-dismiss="modal"><i class="fal fa-plus"></i> Widget hinzufügen</button>
                    <button class="btn btn-danger" data-bind='click: clearWidgets'><i class="fal fa-trash"></i> Alle Widgets entfernen</button>

                    <h4 class="mt-5">Fahrzeuge und AAO</h4>
                    <button class="btn btn-secondary" data-bind='click: board().openVehicleModal' data-dismiss="modal"><i class="fal fa-cogs"></i> Fahrzeugeinstellungen öffnen</button>
                    <button class="btn btn-secondary mt-2" data-bind='click: board().openAAOModal' data-dismiss="modal"><i class="fal fa-cogs"></i> AAO-Einstellungen öffnen</button>

                    <h4 class="mt-5">EinsatzMonitor Einstellungen</h4>
                    <button class="btn btn-secondary" data-bind='click: board().openSettingsModal' data-dismiss="modal"><i class="fal fa-cogs"></i> Einstellungen öffnen</button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Einstellungen</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h5 class="card-subtitle mb-2 text-muted">Allgemein</h5>
                    <div class="mb-4" data-bind="template: { name: 'button-template', foreach: $root.settingsModel.settings() }"></div>

                    <h5 class="card-subtitle mb-2 text-muted">Einsatz</h5>
                    <div class="mb-4" data-bind="template: { name: 'button-template', foreach: $root.settingsModel.einsatzSettings() }"></div>

                    <h5 class="card-subtitle mb-2 text-muted">Info</h5>
                    <div class="mb-4" data-bind="template: { name: 'button-template', foreach: $root.settingsModel.infoSettings() }"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-bind="click: $root.settingsModel.saveSettings, enable: !$root.settingsModel.saving() ">Speichern <i data-bind="visible: $root.settingsModel.saving()"
                                                                                                                                                             class="fa fa-cog fa-spin fa-fw"></i></button>
                    <button type="button" class="btn btn-secondary" data-bind='click: board().openSettingsMenuModal' data-dismiss="modal">Zurück</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/html" id="button-template">
        <div class="input-group input-group-sm mb-2">
            <div class="input-group-prepend">
                <span data-bind="text: key" class="input-group-text" id="basic-addon1" style="min-width: 180px;"></span>
            </div>
            <!-- ko if: type() === "Boolean" -->
            <select class="custom-select" data-bind="options: booleanValues, value: value, optionsCaption: 'Please select...', optionsText: 'name', optionsValue: 'id'"></select>
            <!-- /ko -->

            <!-- ko if: type() === "FetchType" -->
            <select class="custom-select" data-bind="options: fetchValues, value: value, optionsCaption: 'Please select...', optionsText: 'name', optionsValue: 'name'"></select>
            <!-- /ko -->

            <!-- ko if: type() === "String" -->
            <input data-bind="textInput: value" type="text" class="form-control" placeholder="Value" aria-label="Text" aria-describedby="basic-addon1">
            <!-- /ko -->

            <!-- <div data-bind="text: get_value"></div> -->
        </div>
    </script>

    <!-- Vehicle settings -->
    <div id="vehiclesModel" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Fahrzeugeinstellungen</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <button class="btn btn-success" data-bind="click: $root.vehicleModel.loadVehiclesFromDisk">Aus Einstellungen laden</button>

                    <h5 class="mt-3"><strong>Fahrzeuge</strong></h5>
                    <table class="table table-sm">
                        <thead>
                        <tr>
                            <th scope="col">Status</th>
                            <th scope="col">Wache</th>
                            <th scope="col">ISSI</th>
                            <th scope="col">Name</th>
                            <th scope="col"></th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach: $root.vehicleModel.vehicles">
                        <tr>
                            <th scope="row" data-bind="text: statusCode"></th>
                            <td data-bind="text: station"></td>
                            <td data-bind="text: identification"></td>
                            <td data-bind="text: name"></td>
                            <td><button class="btn btn-sm btn-danger" data-bind="click:$root.vehicleModel.removeVehicle" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-trash-alt"></i></button></td>
                        </tr>
                        </tbody>
                    </table>

                    <h5 class="mt-3"><strong>Fahrzeug hinzufügen</strong></h5>
                    <form>
                        <div class="form-row">
                            <div class="col">
                                <label for="vehicleStationInput">Wache</label>
                                <input id="vehicleStationInput" type="text" class="form-control" data-bind="textInput: $root.vehicleModel.newVehicle.station" placeholder="Wache"/>
                            </div>
                            <div class="col">
                                <label for="vehicleIdentificationInput">ISSI</label>
                                <input id="vehicleIdentificationInput" type="text" class="form-control" data-bind="textInput: $root.vehicleModel.newVehicle.identification" placeholder="ISSI"/>
                            </div>
                            <div class="col">
                                <label for="vehicleNameInput">Name</label>
                                <input id="vehicleNameInput" type="text" class="form-control" data-bind="textInput: $root.vehicleModel.newVehicle.name" placeholder="Bezeichnung"/>
                            </div>
                            <div class="col">
                                <button class="btn btn-block btn-primary" style="bottom: 0; position: absolute;" data-bind="click: $root.vehicleModel.addNewVehicle">Hinzufügen </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-bind="click: $root.vehicleModel.saveVehiclesToDisk, enable: !$root.vehicleModel.saving() ">Speichern <i data-bind="visible: $root.vehicleModel.saving()"
                                                                                                                                                                 class="fa fa-cog fa-spin fa-fw"></i></button>
                    <button type="button" class="btn btn-secondary" data-bind='click: board().openSettingsMenuModal' data-dismiss="modal">Zurück</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AAO settings -->
    <div id="aaoModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-scrollable modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">AAO-Einstellungen</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h5><strong>Aktive AAOs</strong></h5>

                    <table class="table table-hover table-sm">
                        <thead>
                        <tr>
                            <th style="width: 10%">Name</th>
                            <th style="width: 15%">Stichwörter</th>
                            <th style="width: 19%">Meldebilder</th>
                            <th style="width: 13%">Orte</th>
                            <th style="width: 15%">Objekte</th>
                            <th style="width: 5%">Fahrzeuge</th>
                            <th style="width: 15%">Zeitraum</th>
                            <th style="width: 8%"></th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach: $root.aaoModel.aaos">
                        <tr>
                            <th scope="row" data-bind="text: name"></th>

                            <td data-bind="text: keywords, visible: keywords().length > 0"></td>
                            <td data-bind="visible: keywords().length == 0"><code>alle</code></td>

                            <td data-bind="text: keywordDescriptions, visible: keywordDescriptions().length > 0"></td>
                            <td data-bind="visible: keywordDescriptions().length == 0"><code>alle</code></td>

                            <td data-bind="text: cities, visible: cities().length > 0"></td>
                            <td data-bind="visible: cities().length == 0"><code>alle</code></td>

                            <td data-bind="text: objects, visible: objects().length > 0"></td>
                            <td data-bind="visible: objects().length == 0"><code>alle</code></td>
<!--                            <td data-bind="text: enabledTimeFrameDisplay"></td>-->
                            <td><span data-bind="text: assignedVehicles" class="badge badge-pill badge-danger">Danger</span></td>
                            <td>
                                <div>
                                    <i class="fal fa-calendar-alt"></i>
                                    <span class="text-success" data-bind="visible: monday()"><strong>M</strong></span>
                                    <span class="text-danger" data-bind="visible: !monday()"><strong>M</strong></span>
                                    <span class="text-success" data-bind="visible: tuesday()"><strong>D</strong></span>
                                    <span class="text-danger" data-bind="visible: !tuesday()"><strong>D</strong></span>
                                    <span class="text-success" data-bind="visible: wednesday()"><strong>M</strong></span>
                                    <span class="text-danger" data-bind="visible: !wednesday()"><strong>M</strong></span>
                                    <span class="text-success" data-bind="visible: thursday()"><strong>D</strong></span>
                                    <span class="text-danger" data-bind="visible: !thursday()"><strong>D</strong></span>
                                    <span class="text-success" data-bind="visible: friday()"><strong>F</strong></span>
                                    <span class="text-danger" data-bind="visible: !friday()"><strong>F</strong></span>
                                    <span class="text-success" data-bind="visible: saturday()"><strong>S</strong></span>
                                    <span class="text-danger" data-bind="visible: !saturday()"><strong>S</strong></span>
                                    <span class="text-success" data-bind="visible: sunday()"><strong>S</strong></span>
                                    <span class="text-danger" data-bind="visible: !sunday()"><strong>S</strong></span>

                                </div>

                                <div style="font-size: 13px; display: inline;">
                                    <i class="fal fa-clock"></i>
                                    <span class="" data-bind="text: startTime"></span>
                                    <span> - </span>
                                    <span class="" data-bind="text: endTime"></span>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-warning" data-bind="click:$root.aaoModel.editAao" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-pen"></i></button>
                                <button class="btn btn-sm btn-danger" data-bind="click:$root.aaoModel.removeAao" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-trash-alt"></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <hr>

                    <h5 class="mt-3"><strong>AAO hinzufügen</strong></h5>
                    <form>
                        <div class="form-row">
                            <div class="form-group col-md-8">
                                <label for="aaoNameInput"><strong>Name</strong></label>
                                <input id="aaoNameInput" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newAao().name" placeholder="Name"/>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="aaoCustomField"><strong>Eigener Parameter</strong> <span class="badge badge-light" data-bind="text: $root.aaoModel.newAao().customParameterName"></span></label>
                                <input id="aaoCustomField" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newAao().customParameter" placeholder="Eigener Parameter"/>
                            </div>
                        </div>

                        <div class="alert alert-warning" role="alert">
                            Stichwörter, Meldebilder, Orte und Objekte sind <strong>oder</strong>-verknüpft. Sobald also einer der Einträge gefunden wird, wird die AAO als gültig angesehen.
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-3">
                                <label for="aaoKeywords"><strong>Stichwörter</strong> <span class="badge badge-light">keyword</span></label>

                                <ul class="list-group mb-2" data-bind="foreach: $root.aaoModel.newAao().keywords">
                                    <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: .25rem .50rem;">
                                        <span data-bind="text: $data"></span>
                                        <button style="padding: .10rem .25rem; font-size: .675rem; height: 80%" class="btn btn-sm btn-danger" data-bind="click: $root.aaoModel.newAao().removeKeyword" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-minus"></i></button>
                                    </li>
                                </ul>

                                <div class="input-group input-group-sm">
                                    <input id="aaoKeywords" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newKeyword" placeholder="F1"/>
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button" id="button-addon1" data-bind="click: $root.aaoModel.addNewKeyword">Hinzufügen</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="aaoKeywordDescriptions"><strong>Meldebilder</strong> <span class="badge badge-light">keyword_description</span></label>

                                <ul class="list-group mb-2" data-bind="foreach: $root.aaoModel.newAao().keywordDescriptions">
                                    <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: .25rem .50rem;">
                                        <span data-bind="text: $data"></span>
                                        <button style="padding: .10rem .25rem; font-size: .675rem; height: 80%" class="btn btn-sm btn-danger" data-bind="click: $root.aaoModel.newAao().removeKeywordDescription" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-minus"></i></button>
                                    </li>
                                </ul>

                                <div class="input-group input-group-sm">
                                    <input id="aaoKeywordDescriptions" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newKeywordDescription" placeholder="Brennt Mülleimer"/>
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button" id="button-addon2" data-bind="click: $root.aaoModel.addNewKeywordDescription">Hinzufügen</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="aaoCities"><strong>Orte</strong> <span class="badge badge-light">city</span></label>

                                <ul class="list-group mb-2" data-bind="foreach: $root.aaoModel.newAao().cities">
                                    <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: .25rem .50rem;">
                                        <span data-bind="text: $data"></span>
                                        <button style="padding: .10rem .25rem; font-size: .675rem; height: 80%" class="btn btn-sm btn-danger" data-bind="click: $root.aaoModel.newAao().removeCity" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-minus"></i></button>
                                    </li>
                                </ul>

                                <div class="input-group input-group-sm">
                                    <input id="aaoCities" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newCity" placeholder="Winsen"/>
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button" id="button-addon3" data-bind="click: $root.aaoModel.addNewCity">Hinzufügen</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="aaoObjects"><strong>Objekte</strong> <span class="badge badge-light">object</span></label>

                                <ul class="list-group mb-2" data-bind="foreach: $root.aaoModel.newAao().objects">
                                    <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: .25rem .50rem;">
                                        <span data-bind="text: $data"></span>
                                        <button style="padding: .10rem .25rem; font-size: .675rem; height: 80%" class="btn btn-sm btn-danger" data-bind="click: $root.aaoModel.newAao().removeObject" data-toggle="tooltip" data-placement="top" title="löschen"><i class="fal fa-minus"></i></button>
                                    </li>
                                </ul>

                                <div class="input-group input-group-sm">
                                    <input id="aaoObjects" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newObject" placeholder="Kreishaus Winsen (Luhe)"/>
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button" id="button-addon4" data-bind="click: $root.aaoModel.addNewObject">Hinzufügen</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-8">
                                <label><strong>Wochentage</strong></label>
                                <div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoMonday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().monday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoMonday">
                                            Montag
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoTuesday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().tuesday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoTuesday">
                                            Dienstag
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoWednesday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().wednesday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoWednesday">
                                            Mittwoch
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoThursday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().thursday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoThursday">
                                            Donnerstag
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoFriday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().friday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoFriday">
                                            Freitag
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoSaturday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().saturday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoSaturday">
                                            Samstag
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input id="aaoSunday" type="checkbox" class="form-check-input" data-bind="checked: $root.aaoModel.newAao().sunday" placeholder="Montag"/>
                                        <label class="form-check-label" for="aaoSunday">
                                            Sonntag
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-2">
                                <label for="aaoStartTime"><strong>Start-Uhrzeit</strong></label>
                                <input id="aaoStartTime" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newAao().startTime" placeholder="00:00"/>
                            </div>
                            <div class="form-group col-md-2">
                                <label for="aaoEndTime"><strong>End-Uhrzeit</strong></label>
                                <input id="aaoEndTime" type="text" class="form-control" data-bind="textInput: $root.aaoModel.newAao().endTime" placeholder="24:00"/>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <button class="btn btn-block btn-outline-success" data-bind="click: $root.aaoModel.openVehicleSelectModal">
                                    Fahrzeuge auswählen (<strong><span data-bind="text: $root.aaoModel.newAao().assignedVehicles"></span></strong> zugeordnet)</button>
                                <button class="btn btn-block btn-primary" data-bind="click: $root.aaoModel.addNewAao">AAO hinzufügen</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-bind="click: $root.aaoModel.loadAaoFromDisk">Aus Einstellungen laden</button>

                    <button class="btn btn-success" data-bind="click: $root.aaoModel.saveAaoToDisk, enable: !$root.aaoModel.saving() ">Speichern <i data-bind="visible: $root.aaoModel.saving()"
                                                                                                                                                                 class="fa fa-cog fa-spin fa-fw"></i></button>
                    <button type="button" class="btn btn-secondary" data-bind='click: board().openSettingsMenuModal' data-dismiss="modal">Zurück</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AAO settings - VehicleSelect -->
    <div id="aaoModalVehicleSelect" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">AAO-Einstellungen Fahrzeugauswahl</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning mb-0" role="alert">
                        Fahrzeuge per Drag & Drop zuordnen.
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h4 class="mt-3"><strong>Verfügbare Fahrzeuge</strong></h4>
                            <ul id="sourceAaoVehicles" class="list-group mb-2" data-bind="sortable: {foreach: $root.aaoModel.newAao().availableVehiclesList, options: {group: {pull: true, put: true}}}">
                                <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: .25rem .50rem; cursor: pointer">
                                    <span data-bind="text: name"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h4 class="mt-3"><strong>Prio 1 Fahrzeuge</strong></h4>
                            <ul id="vehicles1" class="list-group mb-2" data-bind="sortable: {foreach: $root.aaoModel.newAao().vehicles1, options: {pull: true, put: true}}">
                                <li class="list-group-item d-flex justify-content-between align-items-center" data-bind="attr: {'data-id': identification}" style="padding: .25rem .50rem; cursor: pointer">
                                    <span data-bind="text: name"></span>
                                </li>
                            </ul>

                            <h4 class="mt-3"><strong>Prio 2 Fahrzeuge</strong></h4>
                            <ul id="vehicles2" class="list-group mb-2" data-bind="sortable: {foreach: $root.aaoModel.newAao().vehicles2, options: {pull: true, put: true}}">
                                <li class="list-group-item d-flex justify-content-between align-items-center" data-bind="attr: {'data-id': identification}" style="padding: .25rem .50rem; cursor: pointer">
                                    <span data-bind="text: name"></span>
                                </li>
                            </ul>

                            <h4 class="mt-3"><strong>Prio 3 Fahrzeuge</strong></h4>
                            <ul id="vehicles3" class="list-group mb-2" data-bind="sortable: {foreach: $root.aaoModel.newAao().vehicles3, options: {pull: true, put: true}}">
                                <li class="list-group-item d-flex justify-content-between align-items-center" data-bind="attr: {'data-id': identification}" style="padding: .25rem .50rem; cursor: pointer">
                                    <span data-bind="text: name"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>


    <div class="window-buttons-wrapper version-info mr-2 mb-2 p-1" style="position:fixed; right:0; bottom:0;">
        <small id="app-version" class="text-muted text-white">EinsatzMonitor V0.0.0</small>
    </div>

    <div class="window-buttons-wrapper version-info mr-2 mb-2 p-1" style="position:fixed; bottom:0; z-index: 1000;">
        <div class="buttons">
            <button class="btn btn-outline-secondary mr-2" style="padding: 0 4px;" data-bind='click: board().openSettingsMenuModal' data-toggle="tooltip" data-placement="top" title="Einstellungen"><i class="fal fa-cogs"></i></button>
            <button class="btn btn-outline-warning mr-2" style="padding: 0 4px;" data-bind='click: board().toggleEditMode' data-toggle="tooltip" data-placement="top" title="Toggle Edit-Mode"><i class="fal fa-pencil-alt"></i></button>
        </div>
    </div>

    <div class="window-buttons-wrapper mr-1 p-1 close-button-wrapper" style="position:fixed; right:0; top:0; z-index: 1000;">
        <div class="buttons">
            <button id="console-button" class="btn btn-sm btn-outline-primary console-button" style="padding: 0 5px; width: 28px;"><i class="far fa-terminal"></i></button>
            <button id="toolbar-button" class="btn btn-sm btn-outline-primary toolbar-button" style="padding: 0 5px; width: 28px;"><i class="fal fa-wrench"></i></button>
            <button id="fullscreen-button" class="btn btn-sm btn-outline-primary fullscreen-button" style="padding: 0 5px; width: 28px;"><i class="fal fa-window-restore"></i></button>
            <button id="close-button" class="btn btn-sm btn-outline-danger close-button" style="padding: 0 5px; width: 28px;"><i class="fal fa-times"></i></button>
        </div>
    </div>
</div>

<!-- Insert this line above script imports  -->
<script>
    if (typeof module === 'object') {
        window.module = module;
        module = undefined;
    }

    const settings = require('electron-settings');
    const log = require("electron-log");
</script>

<script src="./static/js/jquery.min.js"></script>
<script type='text/javascript' src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script> <!-- need to be loaded before bootstrap -->

<script src="./static/js/popper.min.js"></script>
<script src="./static/js/bootstrap.min.js"></script>

<!-- bootstrap colorpicker -->
<script src="./static/js/bootstrap-colorpicker.min.js"></script>

<!-- knockoutjs -->
<script src="./static/js/knockout.min.js"></script>

<script type='text/javascript' src="./static/js/ko.observableDictionary.js"></script>

<!-- gridster.js -->
<script src="./static/js/gridster.with-extras.js"></script>

<!-- custom textFit -->
<script src="./static/js/customTextFit.js"></script>

<!-- sentry -->
<!-- Todo: move sentry code to the top -->
<script>
    if (settings.getSync("sentry.enabled")) {
        let Sentry = require('@sentry/browser');
        Sentry.init({
            dsn: settings.getSync("sentry.dsn")
        });
    }
</script>

<!-- google maps -->
<script>
    function isDev() {
        log.info(`Environment: ${process.env?.NODE_ENV?.trim()}`);
        return process.env?.NODE_ENV?.trim() === 'dev';
    }

    function loadBundle() {
        let scriptSrc = isDev() ? 'http://localhost:8080/ui-bundle.js' : './dist/ui-bundle.js';

        let script = document.createElement('script');
        script.id = "appBundle";
        script.type = 'text/javascript';
        script.src = scriptSrc;
        document.body.appendChild(script);
        log.info("Loaded javascript bundle")
    }

    window.onload = () => {
        loadBundle();
    };

</script>

<!-- window buttons -->
<script>
    const close_button = document.getElementById('close-button');
    const fullscreen_button = document.getElementById('fullscreen-button');
    const toolbar_button = document.getElementById('toolbar-button');
    const console_button = document.getElementById('console-button');
    let win = require('electron').remote.getCurrentWindow();

    close_button.addEventListener('click', () => {
        win.close();
    });

    fullscreen_button.addEventListener('click', () => {
        win.setFullScreen(!win.isFullScreen());
    });

    toolbar_button.addEventListener('click', () => {
        win.setMenuBarVisibility(!win.isMenuBarVisible());
    });

    console_button.addEventListener('click', () => {
        win.webContents.openDevTools();
    });

    // Tooltips
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
</script>

<!-- version display -->
<script>
    const version_container = document.getElementById('app-version');
    const appVersion = window.require('electron').remote.app.getVersion();
    const versionString = `EinsatzMonitor V${appVersion}`;

    version_container.innerHTML = versionString;
</script>

<!-- Insert this line after script imports -->
<script>if (window.module) module = window.module;</script>
</body>
</html>
